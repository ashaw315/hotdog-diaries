<!DOCTYPE html>
<html>
<head>
    <title>Loading Timing Test</title>
    <script>
        async function testApiSpeed() {
            console.log('ðŸ”§ Testing API speed...');
            
            // Test the single post endpoint
            const start1 = Date.now();
            const response1 = await fetch('/api/content?limit=1');
            const end1 = Date.now();
            const data1 = await response1.json();
            console.log(`ðŸ“Š Single post API: ${end1 - start1}ms, posts: ${data1.data?.content?.length || 0}`);
            
            // Test the full endpoint
            const start2 = Date.now();
            const response2 = await fetch('/api/content?limit=50');
            const end2 = Date.now();
            const data2 = await response2.json();
            console.log(`ðŸ“Š Full posts API: ${end2 - start2}ms, posts: ${data2.data?.content?.length || 0}`);
            
            // Test page load simulation
            console.log(`ðŸ“Š Expected performance:`);
            console.log(`  - Cover click to loading: 0ms`);
            console.log(`  - Loading animation: 2000ms (forced)`);
            console.log(`  - First post API: ${end1 - start1}ms`);
            console.log(`  - Total perceived time: ~${Math.max(2000, end1 - start1)}ms`);
            
            // Simulate the loading behavior
            console.log('\nðŸŽ¬ Simulating loading behavior...');
            
            const loadStart = Date.now();
            console.log('1. User clicks cover (starting fetchInitialPost)');
            
            setTimeout(() => console.log('2. Loading animation should be visible'), 100);
            
            setTimeout(() => {
                const elapsed = Date.now() - loadStart;
                console.log(`3. Loading animation finished after ${elapsed}ms`);
                console.log('4. Feed should appear now');
            }, 2000);
        }
        
        // Run test when page loads
        setTimeout(testApiSpeed, 1000);
    </script>
</head>
<body>
    <h1>Loading Performance Test</h1>
    <p>Check the browser console for timing results.</p>
    <p>This tests the API endpoints to understand loading performance.</p>
</body>
</html>