exports.id=9107,exports.ids=[9107],exports.modules={1586:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{Bv:()=>g});var e=c(7462);c(85663),c(55511);var f=a([e]);e=(f.then?(await f)():f)[0];class g{static async create(a){return(await e.db.query(`
      INSERT INTO posted_content (content_queue_id, posted_at, scheduled_time, post_order)
      VALUES ($1, NOW(), $2, $3)
      RETURNING *
    `,[a.content_queue_id,a.scheduled_time,a.post_order])).rows[0]}static async findById(a){return(await e.db.query("SELECT * FROM posted_content WHERE id = $1",[a])).rows[0]||null}static async findWithContent(a=10,b=0){return(await e.db.query(`
      SELECT * FROM posted_content_with_details
      ORDER BY posted_at DESC
      LIMIT $1 OFFSET $2
    `,[a,b])).rows}static async getPostsForToday(){return(await e.db.query(`
      SELECT * FROM posted_content 
      WHERE DATE(posted_at) = CURRENT_DATE
      ORDER BY post_order ASC
    `)).rows}static async getNextPostOrder(){let a=await e.db.query(`
      SELECT COALESCE(MAX(post_order), 0) + 1 as next_order
      FROM posted_content 
      WHERE DATE(posted_at) = CURRENT_DATE
    `);return a.rows[0]?.next_order||1}}d()}catch(a){d(a)}})},2986:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{f:()=>l});var e=c(35144),f=c(55229),g=c(99342),h=c(87049),i=c(7462),j=c(1586),k=a([f,i,j]);[f,i,j]=k.then?(await k)():k;class l{static async createContent(a){let b=(0,h.mS)(a);if(!b.isValid){let a=b.errors.map(a=>`${a.field}: ${a.message}`).join(", ");throw Error(`Validation failed: ${a}`)}let c=(0,g.LQ)({content_text:a.content_text,content_image_url:a.content_image_url,content_video_url:a.content_video_url,original_url:a.original_url}),d=await this.findByHash(c);if(d)throw Error(`Duplicate content detected. Existing content ID: ${d.id}`);try{let b=await (0,f.Yr)("content_queue").values({content_text:a.content_text,content_image_url:a.content_image_url,content_video_url:a.content_video_url,content_type:a.content_type,source_platform:a.source_platform,original_url:a.original_url,original_author:a.original_author,scraped_at:new Date,content_hash:c,is_posted:!1,is_approved:a.is_approved??!1,admin_notes:a.admin_notes,created_at:new Date,updated_at:new Date}).first();if(!b)throw Error("Failed to create content");return await (0,i.rP)(e.$b.INFO,`Content created: ${b.id}`,"content-service",{contentId:b.id,contentType:b.content_type,sourcePlatform:b.source_platform,isApproved:b.is_approved}),b}catch(b){throw await (0,i.rP)(e.$b.ERROR,`Failed to create content: ${b instanceof Error?b.message:"Unknown error"}`,"content-service",{data:a,error:b instanceof Error?b.stack:b}),b}}static async getQueuedContent(a,b={}){let{page:c,limit:d,orderBy:e="scraped_at",orderDirection:g="DESC"}=a,h=(0,f.P)("content_queue").select(["*"]).where("is_posted","=",!1);b.content_type&&(h=h.where("content_type","=",b.content_type)),b.source_platform&&(h=h.where("source_platform","=",b.source_platform)),void 0!==b.is_approved&&(h=h.where("is_approved","=",b.is_approved)),b.author&&(h=h.where("original_author","ILIKE",`%${b.author}%`));let i=await h.count(),j=await h.orderBy(e,g).limit(d).offset((c-1)*d).execute(),k=Math.ceil(i/d);return{items:j.rows,pagination:{page:c,limit:d,total:i,totalPages:k,hasNextPage:c<k,hasPreviousPage:c>1}}}static async getPostedContent(a,b={}){let{page:c,limit:d,orderBy:e="posted_at",orderDirection:g="DESC"}=a,h=(0,f.P)("posted_content_with_details").select(["*"]);b.content_type&&(h=h.where("content_type","=",b.content_type)),b.source_platform&&(h=h.where("source_platform","=",b.source_platform)),b.author&&(h=h.where("original_author","ILIKE",`%${b.author}%`));let i=await h.count(),j=await h.orderBy(e,g).limit(d).offset((c-1)*d).execute(),k=Math.ceil(i/d);return{items:j.rows,pagination:{page:c,limit:d,total:i,totalPages:k,hasNextPage:c<k,hasPreviousPage:c>1}}}static async markAsPosted(a,b){try{let c=await this.findById(a);if(!c)throw Error(`Content with ID ${a} not found`);if(c.is_posted)throw Error(`Content with ID ${a} is already posted`);let d=await j.Bv.getNextPostOrder(),g=await (0,f.yo)("content_queue").set({is_posted:!0,posted_at:new Date,updated_at:new Date}).where("id","=",a).first();if(!g)throw Error("Failed to update content as posted");let h=await (0,f.Yr)("posted_content").values({content_queue_id:a,posted_at:new Date,scheduled_time:b,post_order:d,created_at:new Date,updated_at:new Date}).first();if(!h)throw Error("Failed to create posted content record");return await (0,i.rP)(e.$b.INFO,`Content marked as posted: ${a}`,"content-service",{contentId:a,postOrder:d,scheduledTime:b}),{contentQueue:g,postedContent:h}}catch(b){throw await (0,i.rP)(e.$b.ERROR,`Failed to mark content as posted: ${b instanceof Error?b.message:"Unknown error"}`,"content-service",{contentId:a,error:b instanceof Error?b.stack:b}),b}}static async deleteContent(a){try{let b=await this.findById(a);if(!b)throw Error(`Content with ID ${a} not found`);if(b.is_posted)throw Error(`Cannot delete posted content with ID ${a}`);let c=await (0,f.AW)("content_queue").where("id","=",a).first();if(!c)throw Error("Failed to delete content");return await (0,i.rP)(e.$b.INFO,`Content deleted: ${a}`,"content-service",{contentId:a,contentType:c.content_type,sourcePlatform:c.source_platform}),c}catch(b){throw await (0,i.rP)(e.$b.ERROR,`Failed to delete content: ${b instanceof Error?b.message:"Unknown error"}`,"content-service",{contentId:a,error:b instanceof Error?b.stack:b}),b}}static async updateContent(a,b){try{let c=await this.findById(a);if(!c)throw Error(`Content with ID ${a} not found`);if(c.is_posted)throw Error(`Cannot update posted content with ID ${a}`);let d={...b,updated_at:new Date};if(void 0!==b.content_text||void 0!==b.content_image_url||void 0!==b.content_video_url||void 0!==b.original_url){let e=(0,g.LQ)({content_text:b.content_text??c.content_text,content_image_url:b.content_image_url??c.content_image_url,content_video_url:b.content_video_url??c.content_video_url,original_url:b.original_url??c.original_url}),f=await this.findByHash(e);if(f&&f.id!==a)throw Error(`Duplicate content detected. Existing content ID: ${f.id}`);d.content_hash=e}let h=await (0,f.yo)("content_queue").set(d).where("id","=",a).first();if(!h)throw Error("Failed to update content");return await (0,i.rP)(e.$b.INFO,`Content updated: ${a}`,"content-service",{contentId:a,updates:Object.keys(b)}),h}catch(c){throw await (0,i.rP)(e.$b.ERROR,`Failed to update content: ${c instanceof Error?c.message:"Unknown error"}`,"content-service",{contentId:a,updates:b,error:c instanceof Error?c.stack:c}),c}}static async findById(a){return await (0,f.P)("content_queue").where("id","=",a).first()}static async findByHash(a){return await (0,f.P)("content_queue").where("content_hash","=",a).first()}static async getStats(){let[a,b,c,d,e]=await Promise.all([(0,f.P)("content_queue").count(),(0,f.P)("content_queue").where("is_posted","=",!1).count(),(0,f.P)("content_queue").where("is_approved","=",!0).count(),(0,f.P)("content_queue").where("is_posted","=",!0).count(),(0,f.P)("posted_content").where("posted_at",">=",new Date(new Date().setHours(0,0,0,0))).count()]);return{totalContent:a,queuedContent:b,approvedContent:c,postedContent:d,todaysPosts:e}}static async approveContent(a,b){return await this.updateContent(a,{is_approved:!0,admin_notes:b})}static async rejectContent(a,b){return await this.updateContent(a,{is_approved:!1,admin_notes:b})}}d()}catch(a){d(a)}})},7462:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{db:()=>j,rP:()=>h});var e=c(64939),f=c(83376),g=a([e]);e=(g.then?(await g)():g)[0];class i{constructor(){this.pool=null,this.isVercel=!1,this.isVercel=!!process.env.POSTGRES_URL}getConfig(){return this.isVercel?{host:process.env.POSTGRES_HOST,port:5432,database:process.env.POSTGRES_DATABASE,user:process.env.POSTGRES_USER,password:process.env.POSTGRES_PASSWORD,ssl:!0,max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3}:{host:process.env.DATABASE_HOST||"localhost",port:parseInt(process.env.DATABASE_PORT||"5432"),database:process.env.DATABASE_NAME||"hotdog_diaries_dev",user:process.env.DATABASE_USER||"postgres",password:process.env.DATABASE_PASSWORD||"password",ssl:!1,max:10,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3}}async connect(){if(this.pool)return;let a=this.getConfig();this.pool=new e.Pool(a),this.pool.on("error",a=>{console.error("Unexpected database error on idle client",a)}),this.pool.on("connect",()=>{console.log("Database connection established")}),this.pool.on("remove",()=>{console.log("Database connection removed")});try{let a=await this.pool.connect();await a.query("SELECT NOW()"),a.release(),console.log("Database connection successful")}catch(a){throw console.error("Database connection failed:",a),a}}async disconnect(){this.pool&&(await this.pool.end(),this.pool=null,console.log("Database connection closed"))}async query(a,b){if(this.isVercel)return await f.ll.query(a,b||[]);this.pool||await this.connect();let c=Date.now();try{let d=await this.pool.query(a,b),e=Date.now()-c;return console.log("Query executed",{text:a,duration:e,rows:d.rowCount}),d}catch(d){let b=Date.now()-c;throw console.error("Query error",{text:a,duration:b,error:d}),d}}async getClient(){if(this.isVercel)throw Error("Client connections not supported in Vercel environment");if(!this.pool)throw Error("Database not connected");return await this.pool.connect()}async healthCheck(){try{let a=Date.now();await this.query("SELECT 1 as health_check");let b=Date.now()-a;return{connected:!0,latency:b}}catch(a){return{connected:!1,error:a instanceof Error?a.message:"Unknown error"}}}async transaction(a){if(this.isVercel)throw Error("Transactions not supported in Vercel environment with @vercel/postgres");let b=await this.getClient();try{await b.query("BEGIN");let c=await a(b);return await b.query("COMMIT"),c}catch(a){throw await b.query("ROLLBACK"),a}finally{b.release()}}}let j=new i;async function h(a,b,c,d){try{await j.query(`INSERT INTO system_logs (log_level, message, component, metadata, created_at)
       VALUES ($1, $2, $3, $4, NOW())`,[a,b,c,d?JSON.stringify(d):null])}catch(a){console.error("Failed to log to database:",a)}}d()}catch(a){d(a)}})},35144:(a,b,c)=>{"use strict";c.d(b,{$b:()=>f,NR:()=>e,cM:()=>d});var d=function(a){return a.TEXT="text",a.IMAGE="image",a.VIDEO="video",a.MIXED="mixed",a}({}),e=function(a){return a.REDDIT="reddit",a.INSTAGRAM="instagram",a.FACEBOOK="facebook",a.TIKTOK="tiktok",a}({}),f=function(a){return a.DEBUG="debug",a.INFO="info",a.WARN="warn",a.ERROR="error",a.FATAL="fatal",a}({})},47990:()=>{},55229:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{AW:()=>n,P:()=>k,Yr:()=>l,yo:()=>m});var e=c(7462),f=a([e]);e=(f.then?(await f)():f)[0];class g{static table(a){let b=new g;return b.fromTable=a,b}select(a){return"string"==typeof a?this.selectFields=[a]:this.selectFields=a,this}where(a,b,c){return this.whereConditions.push({field:a,operator:b,value:c}),this}whereIn(a,b){return this.whereConditions.push({field:a,operator:"IN",values:b}),this}whereNotIn(a,b){return this.whereConditions.push({field:a,operator:"NOT IN",values:b}),this}whereNull(a){return this.whereConditions.push({field:a,operator:"IS NULL"}),this}whereNotNull(a){return this.whereConditions.push({field:a,operator:"IS NOT NULL"}),this}orderBy(a,b="ASC"){return this.orderByFields.push({field:a,direction:b}),this}join(a,b,c="INNER"){return this.joinClauses.push({type:c,table:a,on:b}),this}leftJoin(a,b){return this.join(a,b,"LEFT")}limit(a){return this.limitCount=a,this}offset(a){return this.offsetCount=a,this}build(){this.parameters=[];let a=1,b=`SELECT ${this.selectFields.join(", ")}`,c=`FROM ${this.fromTable}`;this.joinClauses.length>0&&(c+=" "+this.joinClauses.map(a=>`${a.type} JOIN ${a.table} ON ${a.on}`).join(" "));let d="";if(this.whereConditions.length>0){let b=this.whereConditions.map(b=>{switch(b.operator){case"IS NULL":case"IS NOT NULL":return`${b.field} ${b.operator}`;case"IN":case"NOT IN":if(!b.values||0===b.values.length)throw Error(`${b.operator} requires non-empty values array`);let c=b.values.map(()=>`$${a++}`).join(", ");return this.parameters.push(...b.values),`${b.field} ${b.operator} (${c})`;default:return this.parameters.push(b.value),`${b.field} ${b.operator} $${a++}`}});d=`WHERE ${b.join(" AND ")}`}let e="";if(this.orderByFields.length>0){let a=this.orderByFields.map(a=>`${a.field} ${a.direction}`).join(", ");e=`ORDER BY ${a}`}let f="";void 0!==this.limitCount&&(f=`LIMIT $${a++}`,this.parameters.push(this.limitCount));let g="";return void 0!==this.offsetCount&&(g=`OFFSET $${a++}`,this.parameters.push(this.offsetCount)),{query:[b,c,d,e,f,g].filter(Boolean).join(" "),params:this.parameters}}async execute(){let{query:a,params:b}=this.build();return await e.db.query(a,b)}async first(){return(await this.limit(1).execute()).rows[0]||null}async count(){let a=this.selectFields;this.selectFields=["COUNT(*) as count"];let b=await this.execute();return this.selectFields=a,parseInt(b.rows[0]?.count||"0")}constructor(){this.selectFields=["*"],this.fromTable="",this.whereConditions=[],this.orderByFields=[],this.joinClauses=[],this.parameters=[]}}class h{static into(a){let b=new h;return b.tableName=a,b}values(a){return this.insertData={...this.insertData,...a},this}returning(a){return"string"==typeof a?this.returnFields=[a]:this.returnFields=a,this}onConflict(a,b,c){return this.conflictTarget=a,this.conflictAction=b,this.updateData=c,this}onConflictDoNothing(a){return this.onConflict(a,"DO NOTHING")}onConflictDoUpdate(a,b){return this.onConflict(a,"DO UPDATE",b)}build(){let a=Object.keys(this.insertData),b=Object.values(this.insertData),c=a.map((a,b)=>`$${b+1}`).join(", "),d=`INSERT INTO ${this.tableName} (${a.join(", ")}) VALUES (${c})`;if(this.conflictTarget&&this.conflictAction&&(d+=` ON CONFLICT (${this.conflictTarget}) ${this.conflictAction}`,"DO UPDATE"===this.conflictAction&&this.updateData)){let a=Object.keys(this.updateData).map(a=>`${a} = EXCLUDED.${a}`).join(", ");d+=` SET ${a}`}return this.returnFields.length>0&&(d+=` RETURNING ${this.returnFields.join(", ")}`),{query:d,params:b}}async execute(){let{query:a,params:b}=this.build();return await e.db.query(a,b)}async first(){return(await this.execute()).rows[0]||null}constructor(){this.tableName="",this.insertData={},this.returnFields=["*"]}}class i{static table(a){let b=new i;return b.tableName=a,b}set(a){return this.updateData={...this.updateData,...a},this}where(a,b,c){return this.whereConditions.push({field:a,operator:b,value:c}),this}returning(a){return"string"==typeof a?this.returnFields=[a]:this.returnFields=a,this}build(){this.parameters=[];let a=1,b=Object.keys(this.updateData).map(b=>(this.parameters.push(this.updateData[b]),`${b} = $${a++}`)).join(", "),c=`UPDATE ${this.tableName} SET ${b}`;if(this.whereConditions.length>0){let b=this.whereConditions.map(b=>"IS NULL"===b.operator||"IS NOT NULL"===b.operator?`${b.field} ${b.operator}`:(this.parameters.push(b.value),`${b.field} ${b.operator} $${a++}`));c+=` WHERE ${b.join(" AND ")}`}return this.returnFields.length>0&&(c+=` RETURNING ${this.returnFields.join(", ")}`),{query:c,params:this.parameters}}async execute(){let{query:a,params:b}=this.build();return await e.db.query(a,b)}async first(){return(await this.execute()).rows[0]||null}constructor(){this.tableName="",this.updateData={},this.whereConditions=[],this.returnFields=["*"],this.parameters=[]}}class j{static from(a){let b=new j;return b.tableName=a,b}where(a,b,c){return this.whereConditions.push({field:a,operator:b,value:c}),this}returning(a){return"string"==typeof a?this.returnFields=[a]:this.returnFields=a,this}build(){this.parameters=[];let a=1,b=`DELETE FROM ${this.tableName}`;if(this.whereConditions.length>0){let c=this.whereConditions.map(b=>"IS NULL"===b.operator||"IS NOT NULL"===b.operator?`${b.field} ${b.operator}`:(this.parameters.push(b.value),`${b.field} ${b.operator} $${a++}`));b+=` WHERE ${c.join(" AND ")}`}return this.returnFields.length>0&&(b+=` RETURNING ${this.returnFields.join(", ")}`),{query:b,params:this.parameters}}async execute(){let{query:a,params:b}=this.build();return await e.db.query(a,b)}async first(){return(await this.execute()).rows[0]||null}constructor(){this.tableName="",this.whereConditions=[],this.returnFields=["*"],this.parameters=[]}}let k=g.table,l=h.into,m=i.table,n=j.from;d()}catch(a){d(a)}})},73131:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{$y:()=>n,JV:()=>i,Uj:()=>k,hS:()=>j,l:()=>m,zn:()=>l});var e=c(32190),f=c(7462),g=c(35144),h=a([f]);f=(h.then?(await h)():h)[0];class o extends Error{constructor(a,b=500,c){super(a),this.name="HttpError",this.statusCode=b,this.code=c}}function i(a,b=500,c){return new o(a,b,c)}async function j(a,b,c){let d=500,h="Internal Server Error",i="INTERNAL_ERROR";a instanceof o?(d=a.statusCode,h=a.message,i=a.code||"HTTP_ERROR"):a instanceof Error&&(h=a.message,i="APPLICATION_ERROR");try{await (0,f.rP)(g.$b.ERROR,`API Error in ${c}: ${h}`,"api",{endpoint:c,statusCode:d,code:i,method:b.method,url:b.url,userAgent:b.headers.get("user-agent"),stack:a instanceof Error?a.stack:void 0})}catch(a){console.error("Failed to log error to database:",a)}return e.NextResponse.json({success:!1,error:h,code:i,timestamp:new Date().toISOString()},{status:d})}function k(a,b){return async c=>{try{return await a(c)}catch(a){return await j(a,c,b)}}}function l(a,b){if(!b.includes(a.method))throw i(`Method ${a.method} not allowed`,405,"METHOD_NOT_ALLOWED")}async function m(a){try{return await a.json()}catch{throw i("Invalid JSON in request body",400,"INVALID_JSON")}}function n(a,b,c=200){var d;return(d=e.NextResponse.json({success:!0,data:a,message:b,timestamp:new Date().toISOString()},{status:c})).headers.set("X-Content-Type-Options","nosniff"),d.headers.set("X-Frame-Options","DENY"),d.headers.set("X-XSS-Protection","1; mode=block"),d.headers.set("Referrer-Policy","strict-origin-when-cross-origin"),d.headers.set("Strict-Transport-Security","max-age=31536000; includeSubDomains"),d}d()}catch(a){d(a)}})},78335:()=>{},87049:(a,b,c)=>{"use strict";c.d(b,{TN:()=>g,mS:()=>f});var d=c(35144);class e{static validate(a){let b=[];return Object.values(d.cM).includes(a.content_type)||b.push({field:"content_type",message:`Invalid content type. Must be one of: ${Object.values(d.cM).join(", ")}`}),Object.values(d.NR).includes(a.source_platform)||b.push({field:"source_platform",message:`Invalid source platform. Must be one of: ${Object.values(d.NR).join(", ")}`}),a.original_url&&this.isValidUrl(a.original_url)||b.push({field:"original_url",message:"Valid original URL is required"}),a.content_text||a.content_image_url||a.content_video_url||b.push({field:"content",message:"At least one of content_text, content_image_url, or content_video_url is required"}),this.validateContentTypeMatches(a,b),a.content_image_url&&!this.isValidImageUrl(a.content_image_url)&&b.push({field:"content_image_url",message:"Invalid image URL format"}),a.content_video_url&&!this.isValidVideoUrl(a.content_video_url)&&b.push({field:"content_video_url",message:"Invalid video URL format"}),a.content_text&&a.content_text.length>5e3&&b.push({field:"content_text",message:"Content text must be 5000 characters or less"}),a.original_author&&a.original_author.length>255&&b.push({field:"original_author",message:"Original author must be 255 characters or less"}),b}static validateUpdate(a){let b=[];return a.content_type&&!Object.values(d.cM).includes(a.content_type)&&b.push({field:"content_type",message:`Invalid content type. Must be one of: ${Object.values(d.cM).join(", ")}`}),a.content_image_url&&!this.isValidImageUrl(a.content_image_url)&&b.push({field:"content_image_url",message:"Invalid image URL format"}),a.content_video_url&&!this.isValidVideoUrl(a.content_video_url)&&b.push({field:"content_video_url",message:"Invalid video URL format"}),a.content_text&&a.content_text.length>5e3&&b.push({field:"content_text",message:"Content text must be 5000 characters or less"}),b}static validateContentTypeMatches(a,b){let{content_type:c,content_text:e,content_image_url:f,content_video_url:g}=a;switch(c){case d.cM.TEXT:e||b.push({field:"content_text",message:"content_text is required for text content type"}),(f||g)&&b.push({field:"content_type",message:"Text content type should not include image or video URLs"});break;case d.cM.IMAGE:f||b.push({field:"content_image_url",message:"content_image_url is required for image content type"}),g&&b.push({field:"content_type",message:"Image content type should not include video URL"});break;case d.cM.VIDEO:g||b.push({field:"content_video_url",message:"content_video_url is required for video content type"}),f&&b.push({field:"content_type",message:"Video content type should not include image URL"});case d.cM.MIXED:}}static isValidUrl(a){try{let b=new URL(a);return"http:"===b.protocol||"https:"===b.protocol}catch{return!1}}static isValidImageUrl(a){if(!this.isValidUrl(a))return!1;let b=a.toLowerCase();return[".jpg",".jpeg",".png",".gif",".webp",".svg"].some(a=>b.includes(a))||b.includes("image")||b.includes("photo")||b.includes("picture")||this.isImageHostingService(a)}static isValidVideoUrl(a){if(!this.isValidUrl(a))return!1;let b=a.toLowerCase();return[".mp4",".webm",".ogg",".mov",".avi"].some(a=>b.includes(a))||this.isVideoHostingService(a)}static isImageHostingService(a){return["imgur.com","i.redd.it","pbs.twimg.com","instagram.com","cdn.discordapp.com","media.giphy.com"].some(b=>a.includes(b))}static isVideoHostingService(a){return["youtube.com","youtu.be","vimeo.com","tiktok.com","instagram.com","twitter.com","v.redd.it","gfycat.com","streamable.com"].some(b=>a.includes(b))}}function f(a){let b=e.validate(a);return{isValid:0===b.length,errors:b}}function g(a){let b=e.validateUpdate(a);return{isValid:0===b.length,errors:b}}},96487:()=>{},99342:(a,b,c)=>{"use strict";c.d(b,{LQ:()=>g});var d=c(55511),e=c.n(d);class f{static generateHash(a){let b=a.content_text?this.normalizeText(a.content_text):"",c=a.content_image_url?this.normalizeUrl(a.content_image_url):"",d=[b,c,a.content_video_url?this.normalizeUrl(a.content_video_url):"",this.normalizeUrl(a.original_url)].filter(Boolean).join("|");return e().createHash("sha256").update(d,"utf8").digest("hex")}static generateUrlHash(a){let b=this.normalizeUrl(a);return e().createHash("sha256").update(b,"utf8").digest("hex")}static normalizeText(a){return a.toLowerCase().replace(/\s+/g," ").replace(/[^\w\s]/g,"").trim()}static normalizeUrl(a){try{let b=new URL(a);return["utm_source","utm_medium","utm_campaign","utm_term","utm_content","fbclid","gclid","ref","source","s","t","igshid"].forEach(a=>{b.searchParams.delete(a)}),b.searchParams.sort(),b.hash="",b.pathname=b.pathname.replace(/\/+$/,"")||"/",b.toString().toLowerCase()}catch{return a.toLowerCase().trim()}}static areSimilar(a,b){if(this.normalizeUrl(a.original_url)===this.normalizeUrl(b.original_url))return!0;if(a.content_image_url&&b.content_image_url&&this.normalizeUrl(a.content_image_url)===this.normalizeUrl(b.content_image_url))return!0;if(a.content_video_url&&b.content_video_url&&this.normalizeUrl(a.content_video_url)===this.normalizeUrl(b.content_video_url))return!0;if(a.content_text&&b.content_text){let c=this.normalizeText(a.content_text),d=this.normalizeText(b.content_text);if(c===d||this.calculateTextSimilarity(c,d)>.8)return!0}return!1}static calculateTextSimilarity(a,b){let c=new Set(a.split(" ").filter(a=>a.length>2)),d=new Set(b.split(" ").filter(a=>a.length>2)),e=new Set([...c].filter(a=>d.has(a))),f=new Set([...c,...d]);return 0===f.size?0:e.size/f.size}static generateMultipleHashes(a){let b,c,d=this.generateHash(a),f=this.generateUrlHash(a.original_url);a.content_text&&(b=e().createHash("sha256").update(this.normalizeText(a.content_text),"utf8").digest("hex"));let g=a.content_image_url||a.content_video_url;return g&&(c=e().createHash("sha256").update(this.normalizeUrl(g),"utf8").digest("hex")),{contentHash:d,urlHash:f,textHash:b,mediaHash:c}}}function g(a){return f.generateHash(a)}}};