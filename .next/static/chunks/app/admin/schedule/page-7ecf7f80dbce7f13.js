(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3838],{846:(e,s,t)=>{Promise.resolve().then(t.bind(t,8340))},8340:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(5155),r=t(2115);function l(e){let{config:s,schedule:t,onConfigUpdate:l,onManualTrigger:n,onPauseResume:i}=e,[d,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(s.meal_times),[x,g]=(0,r.useState)(s.timezone),[h,u]=(0,r.useState)(!1),[b,p]=(0,r.useState)(null),j=async()=>{try{u(!0),p(null);let e=/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/;for(let s of o)if(!e.test(s))throw Error("Invalid time format: ".concat(s,". Use HH:MM format."));if(0===o.length)throw Error("At least one meal time is required");if(o.length>10)throw Error("Maximum 10 meal times allowed");await l({meal_times:o.sort(),timezone:x}),c(!1)}catch(e){p(e instanceof Error?e.message:"Unknown error")}finally{u(!1)}},N=async()=>{try{u(!0),p(null),await n()}catch(e){p(e instanceof Error?e.message:"Unknown error")}finally{u(!1)}},v=async()=>{try{u(!0),p(null),await i(!s.is_enabled)}catch(e){p(e instanceof Error?e.message:"Unknown error")}finally{u(!1)}};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Schedule Settings"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s.is_enabled?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(s.is_enabled?"text-green-700":"text-red-700"),children:s.is_enabled?"Active":"Paused"})]})]}),b&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:(0,a.jsx)("p",{className:"text-red-600 text-sm",children:b})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border-b border-gray-200 pb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Next Post"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Scheduled Time"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:new Date(t.nextPostTime).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Time Until Next"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:(e=>{let s=Math.floor(e/1e3),t=Math.floor(s/3600),a=Math.floor(s%3600/60),r=s%60;return t>0?"".concat(t,"h ").concat(a,"m ").concat(r,"s"):a>0?"".concat(a,"m ").concat(r,"s"):"".concat(r,"s")})(t.timeUntilNext)})]})]}),t.isPostingTime&&(0,a.jsx)("div",{className:"mt-2 bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-yellow-800 font-medium",children:"\uD83D\uDD14 It's posting time!"})})]}),(0,a.jsxs)("div",{className:"border-b border-gray-200 pb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Today's Schedule"}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:t.todaysSchedule.map((e,s)=>(0,a.jsx)("div",{className:"p-3 rounded-lg border ".concat(e.posted?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.time}),e.posted&&(0,a.jsx)("span",{className:"text-green-600 text-sm",children:"✓"})]})},s))})]}),(0,a.jsxs)("div",{className:"border-b border-gray-200 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Meal Times"}),!d&&(0,a.jsx)("button",{onClick:()=>c(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"})]}),d?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:o.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"time",value:e,onChange:e=>((e,s)=>{let t=[...o];t[e]=s,m(t)})(s,e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("button",{onClick:()=>{m(o.filter((e,t)=>t!==s))},className:"text-red-600 hover:text-red-800",children:"✕"})]},s))}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("button",{onClick:()=>{m([...o,"12:00"])},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"+ Add Time"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timezone"}),(0,a.jsx)("input",{type:"text",value:x,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"America/New_York"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:j,disabled:h,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:h?"Saving...":"Save"}),(0,a.jsx)("button",{onClick:()=>{m(s.meal_times),g(s.timezone),c(!1),p(null)},className:"text-gray-600 hover:text-gray-800 px-4 py-2",children:"Cancel"})]})]}):(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:s.meal_times.map((e,s)=>(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e})},s))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("button",{onClick:N,disabled:h,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50",children:h?"Posting...":"Manual Post"}),(0,a.jsx)("button",{onClick:v,disabled:h,className:"px-4 py-2 rounded-md disabled:opacity-50 ".concat(s.is_enabled?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"),children:h?"Updating...":s.is_enabled?"Pause":"Resume"})]})]})]})}function n(e){let{queueStatus:s,stats:t,onRefresh:l}=e,[n,i]=(0,r.useState)(!1),d=async()=>{try{i(!0),await l()}finally{i(!1)}};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Queue Monitor"}),(0,a.jsx)("button",{onClick:d,disabled:n,className:"text-blue-600 hover:text-blue-800 text-sm font-medium disabled:opacity-50",children:n?"Refreshing...":"Refresh"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"border rounded-lg p-4 ".concat((e=>{switch(e){case"critical":return"bg-red-50 border-red-200 text-red-800";case"low":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-green-50 border-green-200 text-green-800"}})(s.alertLevel)),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:(e=>{switch(e){case"critical":return"\uD83D\uDEA8";case"low":return"⚠️";default:return"✅"}})(s.alertLevel)}),(0,a.jsx)("span",{className:"font-medium",children:s.message})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:s.totalApproved}),(0,a.jsx)("div",{className:"text-sm text-blue-800",children:"Approved"})]})}),(0,a.jsx)("div",{className:"bg-yellow-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:s.totalPending}),(0,a.jsx)("div",{className:"text-sm text-yellow-800",children:"Pending"})]})}),(0,a.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:s.totalPosted}),(0,a.jsx)("div",{className:"text-sm text-green-800",children:"Posted"})]})})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 pt-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Queue Health"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(s.isHealthy?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(s.isHealthy?"text-green-700":"text-red-700"),children:s.isHealthy?"Healthy":"Unhealthy"})]})]})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Posting Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Today"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:[t.todaysPosts," posts"]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"This Week"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:[t.thisWeeksPosts," posts"]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"This Month"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:[t.thisMonthsPosts," posts"]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:[t.totalPosts," posts"]})]})]}),(0,a.jsxs)("div",{className:"mt-4 bg-blue-50 rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-sm text-blue-600",children:"Average per Day"}),(0,a.jsxs)("div",{className:"text-lg font-semibold text-blue-900",children:[t.avgPostsPerDay," posts/day"]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Recommendations"}),(0,a.jsxs)("div",{className:"space-y-2",children:[0===s.totalApproved&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-red-800 text-sm",children:"⚠️ No approved content available. Review and approve pending content to resume posting."})}),s.totalApproved>0&&s.totalApproved<=5&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-yellow-800 text-sm",children:"\uD83D\uDCA1 Queue is running low. Consider approving more content to maintain consistent posting."})}),s.totalPending>20&&(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-blue-800 text-sm",children:"\uD83D\uDCDD Large number of pending items. Review and approve content to keep the queue flowing."})}),s.isHealthy&&s.totalApproved>10&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-green-800 text-sm",children:"✅ Queue is healthy with sufficient approved content for consistent posting."})})]})]})]})]})}function i(e){let{onManualTrigger:s}=e,[t,l]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[d,c]=(0,r.useState)(null),o=async()=>{try{let e=await fetch("/api/admin/content/posted?limit=20");if(!e.ok)throw Error("Failed to fetch posting history");let s=await e.json();l(s.content||[]),c(null)}catch(e){c(e instanceof Error?e.message:"Unknown error")}finally{i(!1)}};(0,r.useEffect)(()=>{o()},[]);let m=async e=>{try{await s(e),await o()}catch(e){c(e instanceof Error?e.message:"Unknown error")}};return n?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Posting History"}),(0,a.jsx)("div",{className:"animate-pulse space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},s))})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Posting History"}),(0,a.jsx)("button",{onClick:o,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Refresh"})]}),d&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:(0,a.jsx)("p",{className:"text-red-600 text-sm",children:d})}),(0,a.jsx)("div",{className:"space-y-4",children:0===t.length?(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No posting history available"}):t.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-lg",children:(e=>{switch(e){case"image":return"\uD83D\uDDBC️";case"video":return"\uD83C\uDFA5";case"text":return"\uD83D\uDCDD";default:return"\uD83D\uDCC4"}})(e.content_type)}),(0,a.jsx)("span",{className:"text-lg",children:(e=>{switch(e){case"instagram":return"\uD83D\uDCF8";case"facebook":return"\uD83D\uDCD8";case"reddit":return"\uD83E\uDD16";case"tiktok":return"\uD83C\uDFB5";default:return"\uD83C\uDF10"}})(e.source_platform)}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Post #",e.post_order]}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.posted_at).toLocaleString()})]}),(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("p",{className:"text-gray-900 text-sm",children:e.content_text?e.content_text.length>100?e.content_text.substring(0,100)+"...":e.content_text:e.content_image_url?"Image content":e.content_video_url?"Video content":"Mixed content"})}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.original_author&&(0,a.jsxs)("span",{children:["By: ",e.original_author]}),(0,a.jsxs)("span",{children:["From: ",e.source_platform]}),(0,a.jsx)("a",{href:e.original_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"Original"})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 ml-4",children:(0,a.jsx)("button",{onClick:()=>m(e.content_queue_id),className:"text-blue-600 hover:text-blue-800 text-sm px-2 py-1 rounded border border-blue-300 hover:border-blue-400",children:"Repost"})})]}),e.content_image_url&&(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("img",{src:e.content_image_url,alt:"Content preview",className:"w-full max-w-xs rounded-lg border",loading:"lazy"})})]},e.id))}),t.length>0&&(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("button",{onClick:o,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Load More"})})]})}function d(){let[e,s]=(0,r.useState)(null),[t,d]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null),m=async()=>{try{let e=await fetch("/api/admin/schedule");if(!e.ok)throw Error("Failed to fetch schedule data");let t=await e.json();s(t),o(null)}catch(e){o(e instanceof Error?e.message:"Unknown error")}finally{d(!1)}};(0,r.useEffect)(()=>{m();let e=setInterval(m,3e4);return()=>clearInterval(e)},[]);let x=async e=>{try{if(!(await fetch("/api/admin/schedule",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to update schedule config");await m()}catch(e){throw Error(e instanceof Error?e.message:"Unknown error")}},g=async e=>{try{let s=await fetch("/api/admin/schedule/trigger",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contentId:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to trigger posting")}await m()}catch(e){throw Error(e instanceof Error?e.message:"Unknown error")}},h=async e=>{try{if(!(await fetch("/api/admin/schedule/pause",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({paused:e})})).ok)throw Error("Failed to pause/resume scheduling");await m()}catch(e){throw Error(e instanceof Error?e.message:"Unknown error")}};return t?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})]})}):c?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-red-600",children:c}),(0,a.jsx)("button",{onClick:m,className:"mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Retry"})]})}):e?(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Posting Schedule"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(l,{config:e.config,schedule:e.schedule,onConfigUpdate:x,onManualTrigger:g,onPauseResume:h}),(0,a.jsx)(n,{queueStatus:e.queueStatus,stats:e.stats,onRefresh:m})]}),(0,a.jsx)("div",{children:(0,a.jsx)(i,{onManualTrigger:g})})]})]}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No schedule data available"})})})}}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=846)),_N_E=e.O()}]);