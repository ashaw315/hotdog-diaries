(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7581],{3274:(e,t,r)=>{"use strict";r.d(t,{As:()=>d,Nu:()=>c,OH:()=>l,OJ:()=>o});var a=r(5155),n=r(2115),s=r(5695);let i=(0,n.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,n.useState)({user:null,isLoading:!0,isAuthenticated:!1}),d=(0,s.useRouter)(),c=(0,s.useSearchParams)(),l=async()=>{try{let e=await fetch("/api/admin/me",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok)return(await e.json()).data;return null}catch(e){return console.error("Failed to fetch current user:",e),null}},u=async()=>{o(e=>({...e,isLoading:!0}));try{let e=await l();o({user:e,isLoading:!1,isAuthenticated:!!e})}catch(e){console.error("Auth initialization failed:",e),o({user:null,isLoading:!1,isAuthenticated:!1})}},h=async(e,t)=>{try{let r=await fetch("/api/admin/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),a=await r.json();if(!r.ok)throw Error(a.error||"Login failed");o({user:a.data.user,isLoading:!1,isAuthenticated:!0});let n=c.get("from")||"/admin";d.push(n)}catch(e){throw console.error("Login failed:",e),e}},m=async()=>{try{await fetch("/api/admin/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})}catch(e){console.error("Logout request failed:",e)}finally{o({user:null,isLoading:!1,isAuthenticated:!1}),d.push("/admin/login")}},x=async()=>{let e=await l();o(t=>({...t,user:e,isAuthenticated:!!e}))},p=async()=>{try{if((await fetch("/api/admin/refresh",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)return await x(),!0;return!1}catch(e){return console.error("Token refresh failed:",e),!1}};(0,n.useEffect)(()=>{let e;return r.isAuthenticated&&(e=setInterval(()=>{p()},828e5)),()=>{e&&clearInterval(e)}},[r.isAuthenticated]),(0,n.useEffect)(()=>{let e=async()=>{await p()||(o({user:null,isLoading:!1,isAuthenticated:!1}),"/admin/login"!==window.location.pathname&&d.push("/admin/login"))},t=window.fetch;return window.fetch=async function(){for(var a=arguments.length,n=Array(a),s=0;s<a;s++)n[s]=arguments[s];let i=await t(...n);return 401===i.status&&r.isAuthenticated&&await e(),i},()=>{window.fetch=t}},[r.isAuthenticated,d]),(0,n.useEffect)(()=>{u()},[]);let g={...r,login:h,logout:m,refreshUser:x};return(0,a.jsx)(i.Provider,{value:g,children:t})}function d(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(){let e=d(),t=(0,s.useRouter)();return(0,n.useEffect)(()=>{e.isLoading||e.isAuthenticated||t.push("/admin/login")},[e.isLoading,e.isAuthenticated,t]),e}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/admin",t=d(),r=(0,s.useRouter)();return(0,n.useEffect)(()=>{!t.isLoading&&t.isAuthenticated&&r.push(e)},[t.isLoading,t.isAuthenticated,r,e]),t}},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},7861:(e,t,r)=>{Promise.resolve().then(r.bind(r,7998))},7998:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var a=r(5155),n=r(2115),s=r(5695),i=r(3274);function o(e){let{children:t}=e;return"/admin/login"===(0,s.usePathname)()?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)(d,{children:t})}function d(e){let{children:t}=e,r=(0,i.Nu)();return r.isLoading?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading admin panel..."})]})}):r.isAuthenticated?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(c,{user:r.user,onLogout:r.logout}),(0,a.jsx)("main",{className:"py-6",children:t})]}):null}function c(e){let{user:t,onLogout:r}=e;return(0,a.jsxs)("header",{className:"bg-white shadow",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-2xl mr-3",children:"\uD83C\uDF2D"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Hotdog Diaries Admin"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Content Management System"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(null==t?void 0:t.full_name)||(null==t?void 0:t.username)}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:null==t?void 0:t.email})]}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("button",{onClick:r,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Sign Out"})})]})]})}),(0,a.jsx)("nav",{className:"bg-gray-50 border-t border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex space-x-8",children:[(0,a.jsx)("a",{href:"/admin",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Dashboard"}),(0,a.jsx)("a",{href:"/admin/content",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Content Queue"}),(0,a.jsx)("a",{href:"/admin/posted",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Posted Content"}),(0,a.jsx)("a",{href:"/admin/schedule",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Schedule"}),(0,a.jsx)("a",{href:"/admin/reddit",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Reddit"}),(0,a.jsx)("a",{href:"/admin/instagram",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Instagram"}),(0,a.jsx)("a",{href:"/admin/tiktok",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"TikTok"}),(0,a.jsx)("a",{href:"/admin/social",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Social Media"}),(0,a.jsx)("a",{href:"/admin/monitoring",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Monitoring"}),(0,a.jsx)("a",{href:"/admin/settings",className:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",children:"Settings"})]})})})]})}function l(e){let{children:t}=e;return(0,a.jsx)(i.OJ,{children:(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}),children:(0,a.jsx)(o,{children:t})})})}}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=7861)),_N_E=e.O()}]);