(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5615],{1486:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(5155),i=s(2115);function n(){let[e,t]=(0,i.useState)("config"),[s,n]=(0,i.useState)(null),[r,d]=(0,i.useState)(null),[l,c]=(0,i.useState)(null),[o,m]=(0,i.useState)([]),[x,u]=(0,i.useState)(!0),[g,h]=(0,i.useState)(!1),[p,y]=(0,i.useState)(!1),[f,b]=(0,i.useState)(!1),[j,v]=(0,i.useState)(null);(0,i.useEffect)(()=>{N()},[]);let N=async()=>{u(!0);try{await Promise.all([w(),S(),k(),C()])}catch(e){console.error("Error loading Reddit data:",e),v({type:"error",text:"Failed to load Reddit data"})}finally{u(!1)}},w=async()=>{try{let e=await fetch("/api/admin/reddit/settings"),t=await e.json();t.success&&t.data&&n(t.data)}catch(e){console.error("Error loading Reddit config:",e)}},S=async()=>{try{let e=await fetch("/api/admin/reddit/stats"),t=await e.json();t.success&&t.data&&d(t.data)}catch(e){console.error("Error loading Reddit stats:",e)}},k=async()=>{try{let e=await fetch("/api/admin/reddit/status"),t=await e.json();t.success&&t.data&&c(t.data)}catch(e){console.error("Error loading Reddit status:",e)}},C=async()=>{try{let e=await fetch("/api/admin/reddit/scan-history"),t=await e.json();t.success&&t.data&&m(t.data)}catch(e){console.error("Error loading scan history:",e)}},R=async()=>{if(s){h(!0);try{let e=await fetch("/api/admin/reddit/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json();t.success?(v({type:"success",text:"Reddit configuration saved successfully"}),await N()):v({type:"error",text:t.error||"Failed to save configuration"})}catch(e){v({type:"error",text:"Failed to save configuration"})}finally{h(!1)}}},P=async()=>{y(!0);try{let e=await fetch("/api/admin/reddit/test-connection"),t=await e.json();t.success?(v({type:"success",text:"Reddit API connection successful"}),await k()):v({type:"error",text:t.error||"Connection test failed"})}catch(e){v({type:"error",text:"Connection test failed"})}finally{y(!1)}},E=async()=>{b(!0);try{let e=await fetch("/api/admin/reddit/scan",{method:"POST"}),t=await e.json();t.success?(v({type:"success",text:"Manual scan completed successfully"}),await N()):v({type:"error",text:t.error||"Manual scan failed"})}catch(e){v({type:"error",text:"Manual scan failed"})}finally{b(!1)}},T=(e,t)=>{s&&n({...s,[e]:t})};return x?(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading Reddit settings..."})]})}):(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Reddit Integration"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Configure Reddit content scanning for hotdog discovery"})]}),j&&(0,a.jsx)("div",{className:"mb-4 p-4 rounded-md ".concat("success"===j.type?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:"success"===j.type?"Success":"Error"}),(0,a.jsx)("div",{className:"mt-2 text-sm",children:j.text})]}),(0,a.jsx)("div",{className:"ml-auto pl-3",children:(0,a.jsx)("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600",children:"\xd7"})})]})}),(0,a.jsx)("div",{className:"mb-6 bg-white shadow rounded-lg",children:(0,a.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"API Connection Status"}),(0,a.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat((null==l?void 0:l.isConnected)?"bg-green-400":"bg-red-400")}),(0,a.jsx)("span",{className:"text-sm ".concat((null==l?void 0:l.isConnected)?"text-green-600":"text-red-600"),children:(null==l?void 0:l.isConnected)?"Connected":"Disconnected"})]}),(null==l?void 0:l.rateLimits)&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Rate limit: ",l.rateLimits.used,"/",l.rateLimits.used+l.rateLimits.remaining," requests used"]})]}),(0,a.jsx)("button",{onClick:P,disabled:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Testing..."]}):"Test Connection"})]})})}),(0,a.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{key:"config",label:"Configuration"},{key:"stats",label:"Statistics"},{key:"history",label:"Scan History"}].map(s=>(0,a.jsx)("button",{onClick:()=>t(s.key),className:"whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm ".concat(e===s.key?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:s.label},s.key))})}),"config"===e&&s&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Scanning Configuration"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Enable Reddit Scanning"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("input",{type:"checkbox",checked:s.isEnabled,onChange:e=>T("isEnabled",e.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Scan Interval (minutes)"}),(0,a.jsx)("input",{type:"number",min:"5",max:"1440",value:s.scanInterval,onChange:e=>T("scanInterval",parseInt(e.target.value)),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Max Posts Per Scan"}),(0,a.jsx)("input",{type:"number",min:"1",max:"100",value:s.maxPostsPerScan,onChange:e=>T("maxPostsPerScan",parseInt(e.target.value)),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Minimum Score"}),(0,a.jsx)("input",{type:"number",min:"0",value:s.minScore,onChange:e=>T("minScore",parseInt(e.target.value)),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Sort By"}),(0,a.jsxs)("select",{value:s.sortBy,onChange:e=>T("sortBy",e.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,a.jsx)("option",{value:"hot",children:"Hot"}),(0,a.jsx)("option",{value:"top",children:"Top"}),(0,a.jsx)("option",{value:"new",children:"New"}),(0,a.jsx)("option",{value:"relevance",children:"Relevance"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Time Range"}),(0,a.jsxs)("select",{value:s.timeRange,onChange:e=>T("timeRange",e.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,a.jsx)("option",{value:"hour",children:"Past Hour"}),(0,a.jsx)("option",{value:"day",children:"Past Day"}),(0,a.jsx)("option",{value:"week",children:"Past Week"}),(0,a.jsx)("option",{value:"month",children:"Past Month"}),(0,a.jsx)("option",{value:"year",children:"Past Year"}),(0,a.jsx)("option",{value:"all",children:"All Time"})]})]})]})]})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Target Subreddits"}),(0,a.jsx)("button",{onClick:()=>{if(!s)return;let e=prompt("Enter subreddit name (without r/):");e&&!s.targetSubreddits.includes(e)&&n({...s,targetSubreddits:[...s.targetSubreddits,e.toLowerCase()]})},className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Add Subreddit"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:s.targetSubreddits.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-100 rounded-md px-3 py-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["r/",e]}),(0,a.jsx)("button",{onClick:()=>{s&&n({...s,targetSubreddits:s.targetSubreddits.filter(t=>t!==e)})},className:"text-red-500 hover:text-red-700 ml-2",children:"\xd7"})]},e))})]})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{onClick:E,disabled:f||!s.isEnabled,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Running Scan..."]}):"Run Manual Scan"}),(0,a.jsx)("button",{onClick:R,disabled:g,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Configuration"})]})]}),"stats"===e&&r&&(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Reddit Scanning Statistics"}),(0,a.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Total Scans"}),(0,a.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:r.totalScans})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Posts Found"}),(0,a.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:r.totalPostsFound})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Posts Approved"}),(0,a.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-green-600",children:r.totalPostsApproved})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Success Rate"}),(0,a.jsxs)("dd",{className:"mt-1 text-3xl font-semibold text-indigo-600",children:[r.successRate.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Average Score"}),(0,a.jsx)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:r.averageScore.toFixed(1)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Scan Frequency"}),(0,a.jsxs)("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:[r.scanFrequency,"min"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Last Scan"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:r.lastScanTime?new Date(r.lastScanTime).toLocaleString():"Never"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Next Scan"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:r.nextScanTime?new Date(r.nextScanTime).toLocaleString():"Not scheduled"})]})]})]})}),"history"===e&&(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Recent Scan History"}),o.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scan ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Found"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Approved"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Errors"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900",children:e.scanId.split("_").pop()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.startTime).toLocaleString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.postsFound}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:e.postsApproved}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:e.errors.length})]},e.scanId))})]})}):(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No scan history available"})]})})]})}},2753:(e,t,s)=>{Promise.resolve().then(s.bind(s,1486))}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=2753)),_N_E=e.O()}]);