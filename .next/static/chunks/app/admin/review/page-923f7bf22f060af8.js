(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8739],{415:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(5155),r=t(2115);function l(e){let{flaggedContent:s,onReviewAction:t,onBulkAction:l,onRefresh:i}=e,[n,d]=(0,r.useState)(new Set),[c,o]=(0,r.useState)(!1),[x,m]=(0,r.useState)(null),[g,h]=(0,r.useState)(!1),[p,u]=(0,r.useState)({}),[v,j]=(0,r.useState)(new Set),b=async(e,s)=>{try{m(e);let a=p[e]||"";await t(e,s,"",a);let r=new Set(n);r.delete(e),d(r),o(r.size>0);let l={...p};delete l[e],u(l)}catch(e){console.error("Review action failed:",e)}finally{m(null)}},N=async e=>{try{h(!0),await l(Array.from(n),e,"approve"===e?"Bulk approval":"Bulk rejection"),d(new Set),o(!1)}catch(e){console.error("Bulk action failed:",e)}finally{h(!1)}};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Review Queue"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[s.length," items flagged for review"]})]}),(0,a.jsx)("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Refresh"})]}),c&&(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[n.size," items selected"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>N("approve"),disabled:g,className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 disabled:opacity-50",children:g?"Processing...":"Approve All"}),(0,a.jsx)("button",{onClick:()=>N("reject"),disabled:g,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 disabled:opacity-50",children:g?"Processing...":"Reject All"})]})]})}),s.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("input",{type:"checkbox",checked:n.size===s.length,onChange:()=>{n.size===s.length?(d(new Set),o(!1)):(d(new Set(s.map(e=>e.id))),o(!0))},className:"rounded border-gray-300"}),(0,a.jsxs)("label",{className:"text-sm text-gray-700",children:["Select all (",s.length," items)"]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===s.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)("span",{className:"text-4xl mb-4 block",children:"\uD83C\uDF89"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"No items to review!"}),(0,a.jsx)("p",{className:"text-sm",children:"All content has been processed."})]}):s.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("input",{type:"checkbox",checked:n.has(e.id),onChange:()=>(e=>{let s=new Set(n);s.has(e)?s.delete(e):s.add(e),d(s),o(s.size>0)})(e.id),className:"mt-1 rounded border-gray-300"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"text-lg",children:(e=>{switch(e){case"image":return"\uD83D\uDDBC️";case"video":return"\uD83C\uDFA5";case"text":return"\uD83D\uDCDD";default:return"\uD83D\uDCC4"}})(e.content_type)}),(0,a.jsx)("span",{className:"text-lg",children:(e=>{switch(e){case"instagram":return"\uD83D\uDCF8";case"facebook":return"\uD83D\uDCD8";case"reddit":return"\uD83E\uDD16";case"tiktok":return"\uD83C\uDFB5";default:return"\uD83C\uDF10"}})(e.source_platform)}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleString()}),(0,a.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.is_spam?"bg-red-100 text-red-800":e.is_inappropriate?"bg-orange-100 text-orange-800":e.is_unrelated?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:[e.is_spam?"\uD83D\uDEAB":e.is_inappropriate?"⚠️":e.is_unrelated?"\uD83D\uDD04":"\uD83D\uDEA9"," ",e.flagged_reason]})]}),(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("p",{className:"text-gray-900 text-sm",children:e.content_text?e.content_text.length>150?e.content_text.substring(0,150)+"...":e.content_text:"".concat(e.content_type," content from ").concat(e.source_platform)})}),e.flagged_patterns.length>0&&(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Flagged patterns:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.flagged_patterns.map((e,s)=>(0,a.jsx)("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded text-xs",children:e},s))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-2",children:[e.original_author&&(0,a.jsxs)("span",{children:["By: ",e.original_author]}),(0,a.jsxs)("span",{children:["Confidence: ",(100*e.confidence_score).toFixed(1),"%"]}),(0,a.jsxs)("button",{onClick:()=>(e=>{let s=new Set(v);s.has(e)?s.delete(e):s.add(e),j(s)})(e.id),className:"text-blue-600 hover:text-blue-800",children:[v.has(e.id)?"Less":"More"," details"]})]}),v.has(e.id)&&(0,a.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-3",children:(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Source:"}),(0,a.jsx)("a",{href:e.original_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 ml-1",children:e.original_url})]}),e.processing_notes.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Processing Notes:"}),(0,a.jsx)("ul",{className:"list-disc list-inside ml-4 mt-1",children:e.processing_notes.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-600",children:e},s))})]}),e.content_image_url&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Image:"}),(0,a.jsx)("img",{src:e.content_image_url,alt:"Content",className:"mt-1 max-w-xs rounded border",loading:"lazy"})]}),e.content_video_url&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Video:"}),(0,a.jsx)("a",{href:e.content_video_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 ml-1",children:e.content_video_url})]})]})}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)("textarea",{value:p[e.id]||"",onChange:s=>u(t=>({...t,[e.id]:s.target.value})),placeholder:"Add review notes (optional)...",className:"w-full px-3 py-2 border border-gray-300 rounded text-sm",rows:2})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>b(e.id,"approve"),disabled:x===e.id,className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 disabled:opacity-50",children:x===e.id?"Processing...":"Approve"}),(0,a.jsx)("button",{onClick:()=>b(e.id,"reject"),disabled:x===e.id,className:"bg-red-600 text-white px-4 py-2 rounded text-sm hover:bg-red-700 disabled:opacity-50",children:x===e.id?"Processing...":"Reject"})]})]})]})},e.id))})]})}function i(e){var s,t,l;let{stats:i,onRefresh:n}=e,[d,c]=(0,r.useState)(!1),o=async()=>{try{c(!0),await n()}finally{c(!1)}},x=e=>e<60?"".concat(Math.round(e),"s"):e<3600?"".concat(Math.round(e/60),"m"):"".concat(Math.round(e/3600),"h"),m=0===(s=i.pending_review)?{color:"text-green-600",badge:"bg-green-100 text-green-800",status:"Clear"}:s<=10?{color:"text-yellow-600",badge:"bg-yellow-100 text-yellow-800",status:"Light"}:s<=25?{color:"text-orange-600",badge:"bg-orange-100 text-orange-800",status:"Moderate"}:{color:"text-red-600",badge:"bg-red-100 text-red-800",status:"Heavy"};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Review Statistics"}),(0,a.jsx)("button",{onClick:o,disabled:d,className:"text-blue-600 hover:text-blue-800 text-sm font-medium disabled:opacity-50",children:d?"Refreshing...":"Refresh"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold ".concat(m.color),children:i.pending_review}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Pending Review"}),(0,a.jsxs)("div",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium ".concat(m.badge),children:[m.status," Workload"]})]})}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:i.reviewed_today}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Reviewed Today"})]})}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:i.total_flagged}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Total Flagged"})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Performance"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:"Approval Rate"}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Percentage of reviewed content approved"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-lg font-semibold ".concat((t=i.approval_rate)>=.8?"text-green-600":t>=.6?"text-yellow-600":"text-red-600"),children:[(100*i.approval_rate).toFixed(1),"%"]}),(0,a.jsx)("div",{className:"inline-block px-2 py-1 rounded-full text-xs font-medium ".concat((l=i.approval_rate)>=.8?"bg-green-100 text-green-800":l>=.6?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:i.approval_rate>=.8?"High":i.approval_rate>=.6?"Medium":"Low"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:"Avg Review Time"}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Average time per review"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:x(i.avg_review_time)}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"per item"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:"Review Efficiency"}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Items reviewed per hour"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:i.avg_review_time>0?Math.round(3600/i.avg_review_time):0}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"items/hour"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Workload Analysis"}),(0,a.jsx)("div",{className:"space-y-3",children:0===i.pending_review?(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)("span",{className:"text-4xl mb-2 block",children:"\uD83C\uDF89"}),(0,a.jsx)("p",{className:"text-lg font-medium text-green-600",children:"All caught up!"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"No pending reviews"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Estimated completion:"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:i.avg_review_time>0?x(i.pending_review*i.avg_review_time):"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Review pace needed:"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[Math.ceil(i.pending_review/8)," items/hour"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Workload priority:"}),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(m.color),children:m.status})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("button",{onClick:o,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 text-sm",children:"\uD83D\uDD04 Refresh Data"}),(0,a.jsx)("button",{onClick:()=>window.location.href="/admin/filtering",className:"w-full bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 text-sm",children:"⚙️ Adjust Filters"})]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"\uD83D\uDCA1 Tips"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-blue-800",children:[i.pending_review>20&&(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:"High review backlog. Consider using bulk actions for obvious cases."})]}),i.approval_rate<.5&&(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:"Low approval rate suggests filters may be too strict. Review filter settings."})]}),i.approval_rate>.9&&(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:"High approval rate suggests filters could be more selective to reduce review workload."})]}),i.avg_review_time>300&&(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:"Long review times. Consider improving filter accuracy to reduce complex cases."})]}),i.pending_review<=5&&i.approval_rate>=.6&&i.approval_rate<=.8&&(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{children:"✅"}),(0,a.jsx)("span",{children:"Good balance of automation and human review. System is working well."})]})]})]})]})}function n(){let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(!0),[d,c]=(0,r.useState)(null),o=async()=>{try{let e=await fetch("/api/admin/review-queue");if(!e.ok)throw Error("Failed to fetch review data");let t=await e.json();s(t),c(null)}catch(e){c(e instanceof Error?e.message:"Unknown error")}finally{n(!1)}};(0,r.useEffect)(()=>{o()},[]);let x=async(e,s,t,a)=>{try{if(!(await fetch("/api/admin/content/".concat(e,"/review"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:s,reason:t,notes:a})})).ok)throw Error("Failed to process review action");await o()}catch(e){throw Error(e instanceof Error?e.message:"Unknown error")}},m=async(e,s,t)=>{try{if(!(await fetch("/api/admin/content/bulk-review",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({contentIds:e,action:s,reason:t})})).ok)throw Error("Failed to process bulk action");await o()}catch(e){throw Error(e instanceof Error?e.message:"Unknown error")}};return t?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2 h-96 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-96 bg-gray-200 rounded"})]})]})}):d?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-red-600",children:d}),(0,a.jsx)("button",{onClick:o,className:"mt-4 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Retry"})]})}):e?(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Content Review"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(l,{flaggedContent:e.flaggedContent,onReviewAction:x,onBulkAction:m,onRefresh:o})}),(0,a.jsx)("div",{children:(0,a.jsx)(i,{stats:e.stats,onRefresh:o})})]})]}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No review data available"})})})}},3621:(e,s,t)=>{Promise.resolve().then(t.bind(t,415))}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=3621)),_N_E=e.O()}]);