(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6305],{4650:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(5155),l=s(2115);function r(){let[e,t]=(0,l.useState)([]),[s,r]=(0,l.useState)(!0),[n,d]=(0,l.useState)({status:"all",platform:"all",dateRange:"all"}),[i,o]=(0,l.useState)("posted_at"),[c,m]=(0,l.useState)(1),[x,u]=(0,l.useState)(1),[h,g]=(0,l.useState)(0);(0,l.useEffect)(()=>{p()},[n,i,c]);let p=async()=>{try{r(!0);let e=new URLSearchParams({status:n.status,platform:n.platform,dateRange:n.dateRange,sort:i,page:c.toString(),limit:"20"});"custom"===n.dateRange&&n.startDate&&n.endDate&&(e.append("startDate",n.startDate),e.append("endDate",n.endDate));let s=await fetch("/api/admin/content/history?".concat(e));if(s.ok){let e=await s.json();t(e.content),u(e.totalPages),g(e.totalCount)}else console.error("Failed to fetch content history")}catch(e){console.error("Error fetching content history:",e)}finally{r(!1)}},j=(e,t)=>{d(s=>({...s,[e]:t})),m(1)},v=async()=>{try{let e=new URLSearchParams({status:n.status,platform:n.platform,dateRange:n.dateRange,export:"true"});"custom"===n.dateRange&&n.startDate&&n.endDate&&(e.append("startDate",n.startDate),e.append("endDate",n.endDate));let t=await fetch("/api/admin/content/export?".concat(e));if(t.ok){let e=await t.blob(),s=window.URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="content-history-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),document.body.removeChild(a)}}catch(e){console.error("Error exporting data:",e)}},f=e=>new Date(e).toLocaleString([],{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});return s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse"}),[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-32 bg-gray-200 rounded animate-pulse"},t))]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Content History"}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-600",children:["View and analyze posted content performance (",h," items)"]})]}),(0,a.jsxs)("div",{className:"mt-4 sm:mt-0 flex space-x-2",children:[(0,a.jsxs)("button",{type:"button",onClick:v,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,a.jsx)("span",{className:"text-lg mr-2",children:"\uD83D\uDCE4"}),"Export"]}),(0,a.jsxs)("button",{type:"button",onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,a.jsx)("span",{className:"text-lg mr-2",children:"\uD83D\uDD04"}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,a.jsxs)("select",{id:"status",value:n.status,onChange:e=>j("status",e.target.value),className:"w-full border-gray-300 rounded-md text-sm",children:[(0,a.jsx)("option",{value:"all",children:"All Statuses"}),(0,a.jsx)("option",{value:"posted",children:"Posted"}),(0,a.jsx)("option",{value:"failed",children:"Failed"}),(0,a.jsx)("option",{value:"draft",children:"Draft"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"platform",className:"block text-sm font-medium text-gray-700 mb-1",children:"Platform"}),(0,a.jsxs)("select",{id:"platform",value:n.platform,onChange:e=>j("platform",e.target.value),className:"w-full border-gray-300 rounded-md text-sm",children:[(0,a.jsx)("option",{value:"all",children:"All Platforms"}),(0,a.jsx)("option",{value:"instagram",children:"Instagram"}),(0,a.jsx)("option",{value:"facebook",children:"Facebook"}),(0,a.jsx)("option",{value:"tiktok",children:"TikTok"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"dateRange",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),(0,a.jsxs)("select",{id:"dateRange",value:n.dateRange,onChange:e=>j("dateRange",e.target.value),className:"w-full border-gray-300 rounded-md text-sm",children:[(0,a.jsx)("option",{value:"all",children:"All Time"}),(0,a.jsx)("option",{value:"today",children:"Today"}),(0,a.jsx)("option",{value:"week",children:"This Week"}),(0,a.jsx)("option",{value:"month",children:"This Month"}),(0,a.jsx)("option",{value:"custom",children:"Custom Range"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"sort",className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),(0,a.jsxs)("select",{id:"sort",value:i,onChange:e=>o(e.target.value),className:"w-full border-gray-300 rounded-md text-sm",children:[(0,a.jsx)("option",{value:"posted_at",children:"Posted Date"}),(0,a.jsx)("option",{value:"created_at",children:"Created Date"}),(0,a.jsx)("option",{value:"engagement_rate",children:"Engagement Rate"})]})]})]}),"custom"===n.dateRange&&(0,a.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,a.jsx)("input",{type:"date",id:"startDate",value:n.startDate||"",onChange:e=>j("startDate",e.target.value),className:"w-full border-gray-300 rounded-md text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,a.jsx)("input",{type:"date",id:"endDate",value:n.endDate||"",onChange:e=>j("endDate",e.target.value),className:"w-full border-gray-300 rounded-md text-sm"})]})]})]}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:e.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:e.map(e=>{var t,s,l,r;return(0,a.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[e.media_url&&(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("img",{src:e.media_url,alt:"Content preview",className:"h-20 w-20 object-cover rounded-lg"})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:e.title||"Untitled"}),e.content_text&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 line-clamp-3",children:e.content_text}),e.tags.length>0&&(0,a.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.tags.slice(0,4).map((e,t)=>(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:["#",e]},t)),e.tags.length>4&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.tags.length-4," more"]})]}),"posted"===e.status&&(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-500 mr-1",children:"\uD83D\uDC40"}),(0,a.jsx)("span",{children:(null==(t=e.views)?void 0:t.toLocaleString())||0})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-500 mr-1",children:"❤️"}),(0,a.jsx)("span",{children:(null==(s=e.likes)?void 0:s.toLocaleString())||0})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-500 mr-1",children:"\uD83D\uDD04"}),(0,a.jsx)("span",{children:(null==(l=e.shares)?void 0:l.toLocaleString())||0})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-500 mr-1",children:"\uD83D\uDCAC"}),(0,a.jsx)("span",{children:(null==(r=e.comments)?void 0:r.toLocaleString())||0})]})]})]}),(0,a.jsxs)("div",{className:"ml-4 flex flex-col items-end space-y-2 text-right",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(e){case"posted":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:e.status}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:e.platform})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.posted_at&&(0,a.jsxs)("div",{children:["Posted: ",f(e.posted_at)]}),(0,a.jsxs)("div",{children:["Created: ",f(e.created_at)]}),"posted"===e.status&&(0,a.jsxs)("div",{className:"font-medium text-indigo-600",children:["Engagement: ",(e=>{if(!e.views||0===e.views)return"No data";let t=((e.likes||0)+(e.shares||0)+(e.comments||0))/e.views*100;return"".concat(t.toFixed(1),"%")})(e)]})]})]})]})})]})},e.id)})}),x>1&&(0,a.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",c," of ",x," • ",h," total items"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>m(e=>Math.max(e-1,1)),disabled:1===c,className:"px-3 py-1 text-sm border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>m(e=>Math.min(e+1,x)),disabled:c===x,className:"px-3 py-1 text-sm border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})})]}):(0,a.jsxs)("div",{className:"px-6 py-12 text-center",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCCB"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No content found"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No content matches your current filters."})]})})]})}},4771:(e,t,s)=>{Promise.resolve().then(s.bind(s,4464)),Promise.resolve().then(s.bind(s,4650))}},e=>{e.O(0,[6874,4464,8441,5964,7358],()=>e(e.s=4771)),_N_E=e.O()}]);