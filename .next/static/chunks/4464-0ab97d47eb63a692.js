"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4464],{3274:(e,t,s)=>{s.d(t,{As:()=>o,Nu:()=>d,OH:()=>c,OJ:()=>l});var n=s(5155),a=s(2115),i=s(5695);let r=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[s,l]=(0,a.useState)({user:null,isLoading:!0,isAuthenticated:!1}),o=(0,i.useRouter)(),d=(0,i.useSearchParams)(),c=async()=>{try{let e=await fetch("/api/admin/me",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok)return(await e.json()).data;return null}catch(e){return console.error("Failed to fetch current user:",e),null}},m=async()=>{l(e=>({...e,isLoading:!0}));try{let e=await c();l({user:e,isLoading:!1,isAuthenticated:!!e})}catch(e){console.error("Auth initialization failed:",e),l({user:null,isLoading:!1,isAuthenticated:!1})}},u=async(e,t)=>{try{let s=await fetch("/api/admin/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),n=await s.json();if(!s.ok)throw Error(n.error||"Login failed");l({user:n.data.user,isLoading:!1,isAuthenticated:!0});let a=d.get("from")||"/admin";o.push(a)}catch(e){throw console.error("Login failed:",e),e}},x=async()=>{try{await fetch("/api/admin/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})}catch(e){console.error("Logout request failed:",e)}finally{l({user:null,isLoading:!1,isAuthenticated:!1}),o.push("/admin/login")}},h=async()=>{let e=await c();l(t=>({...t,user:e,isAuthenticated:!!e}))},g=async()=>{try{if((await fetch("/api/admin/refresh",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)return await h(),!0;return!1}catch(e){return console.error("Token refresh failed:",e),!1}};(0,a.useEffect)(()=>{let e;return s.isAuthenticated&&(e=setInterval(()=>{g()},828e5)),()=>{e&&clearInterval(e)}},[s.isAuthenticated]),(0,a.useEffect)(()=>{let e=async()=>{await g()||(l({user:null,isLoading:!1,isAuthenticated:!1}),"/admin/login"!==window.location.pathname&&o.push("/admin/login"))},t=window.fetch;return window.fetch=async function(){for(var n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];let r=await t(...a);return 401===r.status&&s.isAuthenticated&&await e(),r},()=>{window.fetch=t}},[s.isAuthenticated,o]),(0,a.useEffect)(()=>{m()},[]);let f={...s,login:u,logout:x,refreshUser:h};return(0,n.jsx)(r.Provider,{value:f,children:t})}function o(){let e=(0,a.useContext)(r);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function d(){let e=o(),t=(0,i.useRouter)();return(0,a.useEffect)(()=>{e.isLoading||e.isAuthenticated||t.push("/admin/login")},[e.isLoading,e.isAuthenticated,t]),e}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/admin",t=o(),s=(0,i.useRouter)();return(0,a.useEffect)(()=>{!t.isLoading&&t.isAuthenticated&&s.push(e)},[t.isLoading,t.isAuthenticated,s,e]),t}},4464:(e,t,s)=>{s.d(t,{default:()=>u});var n=s(5155),a=s(2115),i=s(3274),r=s(5695);function l(e){let{onMenuToggle:t,isMobileMenuOpen:s}=e,{user:r,logout:l}=(0,i.As)(),[o,d]=(0,a.useState)(!1),c=async()=>{await l()};return(0,n.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,n.jsx)("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{type:"button",className:"md:hidden inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500",onClick:t,"aria-label":"Toggle menu",children:(0,n.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:s?(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}):(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),(0,n.jsxs)("div",{className:"flex items-center ml-4 md:ml-0",children:[(0,n.jsx)("span",{className:"text-2xl mr-3",children:"\uD83C\uDF2D"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Hotdog Diaries Admin"}),(0,n.jsx)("p",{className:"text-xs text-gray-500 hidden sm:block",children:"Content Management System"})]})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("button",{type:"button",className:"p-2 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"View notifications",children:(0,n.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"})})}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("button",{type:"button",className:"flex items-center p-2 text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500",onClick:()=>d(!o),"aria-expanded":o,"aria-haspopup":"true",children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)("div",{className:"hidden sm:block text-right",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(null==r?void 0:r.full_name)||(null==r?void 0:r.username)}),(0,n.jsxs)("p",{className:"text-xs text-gray-500",children:["Last login: ",(e=>{if(!e)return"Never";let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/6e4);return s<60?"".concat(s," minutes ago"):s<1440?"".concat(Math.floor(s/60)," hours ago"):t.toLocaleDateString()})(null==r?void 0:r.last_login_at)]})]}),(0,n.jsx)("div",{className:"h-8 w-8 rounded-full bg-indigo-600 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-sm font-medium text-white",children:((null==r?void 0:r.full_name)||(null==r?void 0:r.username)||"A")[0].toUpperCase()})}),(0,n.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})})]})}),o&&(0,n.jsxs)("div",{className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[(0,n.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-700 border-b border-gray-100",children:[(0,n.jsx)("p",{className:"font-medium",children:(null==r?void 0:r.full_name)||(null==r?void 0:r.username)}),(0,n.jsx)("p",{className:"text-xs text-gray-500 truncate",children:null==r?void 0:r.email})]}),(0,n.jsx)("a",{href:"/admin/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>d(!1),children:"Your Profile"}),(0,n.jsx)("a",{href:"/admin/settings",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>d(!1),children:"Settings"}),(0,n.jsx)("div",{className:"border-t border-gray-100",children:(0,n.jsx)("button",{onClick:c,className:"block w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-50",children:"Sign out"})})]})]})]})]})})})}var o=s(6874),d=s.n(o);let c=[{name:"Dashboard",href:"/admin",icon:"\uD83D\uDCCA",description:"Overview and statistics"},{name:"Content Queue",href:"/admin/queue",icon:"\uD83D\uDCDD",description:"Manage pending content"},{name:"Posted Content",href:"/admin/history",icon:"\uD83D\uDCCB",description:"View content history"},{name:"Content Filtering",href:"/admin/filtering",icon:"\uD83D\uDD0D",description:"Content filtering rules"},{name:"Review Queue",href:"/admin/review",icon:"\uD83D\uDC41️",description:"Review flagged content"},{name:"Content Analytics",href:"/admin/analytics",icon:"\uD83D\uDCC8",description:"Performance metrics"},{name:"Settings",href:"/admin/settings",icon:"⚙️",description:"System configuration"}];function m(e){let{isMobileMenuOpen:t,onMobileMenuClose:s}=e,a=(0,r.usePathname)(),i=(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"md:hidden flex items-center px-4 py-4 border-b border-gray-200",children:[(0,n.jsx)("span",{className:"text-2xl mr-3",children:"\uD83C\uDF2D"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Admin Panel"}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:"Content Management"})]}),(0,n.jsx)("button",{onClick:s,className:"ml-auto p-2 text-gray-400 hover:text-gray-500","aria-label":"Close menu",children:(0,n.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,n.jsxs)("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:[(0,n.jsx)("div",{className:"space-y-1",children:c.map(e=>{var t;let i="/admin"===(t=e.href)?"/admin"===a:a.startsWith(t);return(0,n.jsxs)(d(),{href:e.href,onClick:s,className:"\n                  group flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors duration-150 ease-in-out\n                  ".concat(i?"bg-indigo-100 text-indigo-900 border-r-2 border-indigo-500":"text-gray-700 hover:bg-gray-100 hover:text-gray-900","\n                "),children:[(0,n.jsx)("span",{className:"text-lg mr-3",role:"img","aria-label":e.name,children:e.icon}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:i?"font-semibold":"",children:e.name}),e.count&&(0,n.jsx)("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.count})]}),e.description&&(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]})]},e.name)})}),(0,n.jsxs)("div",{className:"pt-6 border-t border-gray-200 mt-6",children:[(0,n.jsx)("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Quick Actions"}),(0,n.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,n.jsxs)("button",{type:"button",className:"group flex items-center w-full px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[(0,n.jsx)("span",{className:"text-lg mr-3",children:"➕"}),(0,n.jsx)("span",{children:"Add Content"})]}),(0,n.jsxs)("button",{type:"button",className:"group flex items-center w-full px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[(0,n.jsx)("span",{className:"text-lg mr-3",children:"\uD83D\uDD04"}),(0,n.jsx)("span",{children:"Refresh Data"})]}),(0,n.jsxs)("button",{type:"button",className:"group flex items-center w-full px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[(0,n.jsx)("span",{className:"text-lg mr-3",children:"\uD83D\uDCE4"}),(0,n.jsx)("span",{children:"Export Data"})]})]})]}),(0,n.jsxs)("div",{className:"pt-6 border-t border-gray-200 mt-6",children:[(0,n.jsx)("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"System Status"}),(0,n.jsxs)("div",{className:"mt-2 px-3",children:[(0,n.jsxs)("div",{className:"flex items-center text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"h-2 w-2 bg-green-400 rounded-full mr-2"}),(0,n.jsx)("span",{className:"text-gray-600",children:"Database"})]}),(0,n.jsx)("span",{className:"ml-auto text-green-600 font-medium",children:"Online"})]}),(0,n.jsxs)("div",{className:"flex items-center text-sm mt-1",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"h-2 w-2 bg-yellow-400 rounded-full mr-2"}),(0,n.jsx)("span",{className:"text-gray-600",children:"Bot Service"})]}),(0,n.jsx)("span",{className:"ml-auto text-yellow-600 font-medium",children:"Idle"})]})]})]})]}),(0,n.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:[(0,n.jsx)("p",{children:"Hotdog Diaries v1.0"}),(0,n.jsxs)("p",{className:"mt-1",children:["Last updated: ",new Date().toLocaleDateString()]})]})})]});return(0,n.jsxs)(n.Fragment,{children:[t&&(0,n.jsx)("div",{className:"fixed inset-0 z-40 md:hidden","aria-hidden":"true",children:(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:s})}),(0,n.jsx)("div",{className:"\n          fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out md:hidden\n          ".concat(t?"translate-x-0":"-translate-x-full","\n        "),children:i}),(0,n.jsx)("div",{className:"hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0",children:(0,n.jsx)("div",{className:"flex flex-col flex-grow pt-5 bg-white overflow-y-auto border-r border-gray-200",children:i})})]})}function u(e){let{children:t}=e,{user:s,isLoading:o}=(0,i.As)(),d=(0,r.useRouter)(),[c,u]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{o||s||d.push("/admin/login")},[s,o,d]),o)?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),(0,n.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Loading admin panel..."})]})}):s?(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)(m,{isMobileMenuOpen:c,onMobileMenuClose:()=>{u(!1)}}),(0,n.jsxs)("div",{className:"md:pl-64 flex flex-col flex-1",children:[(0,n.jsx)(l,{onMenuToggle:()=>{u(!c)},isMobileMenuOpen:c}),(0,n.jsx)("main",{className:"flex-1",children:(0,n.jsx)("div",{className:"py-6",children:(0,n.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 md:px-8",children:t})})})]})]}):null}},5695:(e,t,s)=>{var n=s(8999);s.o(n,"usePathname")&&s.d(t,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}}),s.o(n,"useSearchParams")&&s.d(t,{useSearchParams:function(){return n.useSearchParams}})}}]);